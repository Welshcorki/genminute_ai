# GenMinute - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡° ë¬¸ì„œ

**ì‘ì„±ì¼**: 2025-01-07
**ë²„ì „**: 1.0
**ëŒ€ìƒ**: ê°œë°œì, ì‹œìŠ¤í…œ ê´€ë¦¬ì

---

## ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°](#1-í”„ë¡œì íŠ¸-ë””ë ‰í† ë¦¬-êµ¬ì¡°)
2. [ì½”ë“œ ì•„í‚¤í…ì²˜](#2-ì½”ë“œ-ì•„í‚¤í…ì²˜)
3. [ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°](#3-ë°ì´í„°ë² ì´ìŠ¤-êµ¬ì¡°)
4. [API ì—”ë“œí¬ì¸íŠ¸](#4-api-ì—”ë“œí¬ì¸íŠ¸)
5. [ì£¼ìš” í´ë˜ìŠ¤ ë° í•¨ìˆ˜](#5-ì£¼ìš”-í´ë˜ìŠ¤-ë°-í•¨ìˆ˜)
6. [ë°ì´í„° íë¦„](#6-ë°ì´í„°-íë¦„)
7. [í™˜ê²½ ì„¤ì •](#7-í™˜ê²½-ì„¤ì •)
8. [ì˜ì¡´ì„±](#8-ì˜ì¡´ì„±)

---

# 1. í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
minute_ai/
â”œâ”€â”€ app.py                          # Flask ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ (1,013ì¤„)
â”œâ”€â”€ .env                            # í™˜ê²½ ë³€ìˆ˜ (API í‚¤, Firebase ì„¤ì •)
â”œâ”€â”€ requirements.txt                # Python ì˜ì¡´ì„± ëª©ë¡
â”‚
â”œâ”€â”€ database/
â”‚   â””â”€â”€ minute_ai.db                # SQLite ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼
â”‚
â”œâ”€â”€ utils/                          # í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ stt.py                      # Gemini STT & AI ì²˜ë¦¬ (300ì¤„)
â”‚   â”œâ”€â”€ db_manager.py               # SQLite ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ (400ì¤„)
â”‚   â”œâ”€â”€ vector_db_manager.py        # ChromaDB ë²¡í„° DB ê´€ë¦¬ (800ì¤„)
â”‚   â”œâ”€â”€ chat_manager.py             # AI ì±—ë´‡ ë¡œì§ (310ì¤„)
â”‚   â”œâ”€â”€ firebase_auth.py            # Firebase ì¸ì¦ ê´€ë¦¬ (80ì¤„)
â”‚   â”œâ”€â”€ user_manager.py             # ì‚¬ìš©ì ë° ê¶Œí•œ ê´€ë¦¬ (450ì¤„)
â”‚   â”œâ”€â”€ decorators.py               # ì¸ì¦ ë°ì½”ë ˆì´í„° (50ì¤„)
â”‚   â”œâ”€â”€ analysis.py                 # í™”ì ë¶„ì„ (100ì¤„)
â”‚   â”œâ”€â”€ validation.py               # ì…ë ¥ ìœ íš¨ì„± ê²€ì‚¬ (150ì¤„)
â”‚   â””â”€â”€ document_converter.py       # ë¬¸ì„œ ë³€í™˜ ìœ í‹¸ë¦¬í‹° (100ì¤„)
â”‚
â”œâ”€â”€ templates/                      # Jinja2 HTML í…œí”Œë¦¿
â”‚   â”œâ”€â”€ layout.html                 # ê³µí†µ ë ˆì´ì•„ì›ƒ (ì±—ë´‡ UI í¬í•¨)
â”‚   â”œâ”€â”€ login.html                  # ë¡œê·¸ì¸ í˜ì´ì§€ (Firebase OAuth)
â”‚   â”œâ”€â”€ index.html                  # ì—…ë¡œë“œ í˜ì´ì§€ (í”„ë¡œê·¸ë ˆìŠ¤ë°”)
â”‚   â”œâ”€â”€ notes.html                  # ëª¨ë“  ë…¸íŠ¸ ëª©ë¡ (ì¼ê´„ ì‚­ì œ)
â”‚   â”œâ”€â”€ shared_notes.html           # ê³µìœ ë°›ì€ ë…¸íŠ¸ ëª©ë¡
â”‚   â”œâ”€â”€ viewer.html                 # íšŒì˜ë¡ ë·°ì–´ (3ê°œ íƒ­)
â”‚   â””â”€â”€ retriever.html              # ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ (Admin)
â”‚
â”œâ”€â”€ static/                         # ì •ì  íŒŒì¼
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css               # ì „ì²´ ìŠ¤íƒ€ì¼ì‹œíŠ¸ (900+ ì¤„)
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ script.js               # ì „ì—­ ìŠ¤í¬ë¦½íŠ¸ (ì±—ë´‡ ë¡œì§ í¬í•¨)
â”‚   â”‚   â””â”€â”€ viewer.js               # ë·°ì–´ ì¸í„°ë™ì…˜ (500+ ì¤„)
â”‚   â””â”€â”€ image/
â”‚       â””â”€â”€ logo.png                # GenMinute ë¡œê³ 
â”‚
â”œâ”€â”€ uploads/                        # ì—…ë¡œë“œëœ ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤ íŒŒì¼
â”‚   â”œâ”€â”€ sample.wav
â”‚   â”œâ”€â”€ meeting.mp4
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ chroma_db/                      # ChromaDB ë²¡í„° ì €ì¥ì†Œ (ìë™ ìƒì„±)
â”‚   â”œâ”€â”€ meeting_chunk/              # ëŒ€í™” ì²­í¬ ì»¬ë ‰ì…˜
â”‚   â””â”€â”€ meeting_subtopic/           # ìš”ì•½ ì»¬ë ‰ì…˜
â”‚
â”œâ”€â”€ ë¬¸ì„œ íŒŒì¼ë“¤
â”‚   â”œâ”€â”€ next.md                     # ì¸ìˆ˜ì¸ê³„ ë¬¸ì„œ (1,600ì¤„)
â”‚   â”œâ”€â”€ FLOWCHART.md                # ì‹œìŠ¤í…œ í”Œë¡œìš°ì°¨íŠ¸
â”‚   â”œâ”€â”€ ui_format.md                # UI ë””ìì¸ ê°€ì´ë“œ
â”‚   â”œâ”€â”€ ë°œí‘œìë£Œ_ì°¸ê³ ë¬¸ì„œ.md        # ë°œí‘œ ìë£Œ ì°¸ê³  ë¬¸ì„œ
â”‚   â”œâ”€â”€ ì‹œìŠ¤í…œêµ¬ì¡°_ë¬¸ì„œ.md          # ì´ ë¬¸ì„œ
â”‚   â”œâ”€â”€ ë°œí‘œì „_í•„ìˆ˜_í…ŒìŠ¤íŠ¸.md       # í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
â”‚   â”œâ”€â”€ ë°œí‘œ_PPT_ë‚´ìš©.md            # PPT ìŠ¬ë¼ì´ë“œ êµ¬ì„±ì•ˆ
â”‚   â”œâ”€â”€ ë°œí‘œ_PPT_ê°œë°œíŒŒíŠ¸.md        # PPT ê°œë°œ íŒŒíŠ¸
â”‚   â”œâ”€â”€ ì´¬ì˜(Filming).md            # ë°ëª¨ ì˜ìƒ ê°€ì´ë“œ
â”‚   â”œâ”€â”€ ê³ ì•„ë°ì´í„°_ë²„ê·¸_ìˆ˜ì •_ì™„ë£Œ.md # ë²„ê·¸ ìˆ˜ì • ë³´ê³ ì„œ
â”‚   â””â”€â”€ JSON_íŒŒì‹±_ì˜¤ë¥˜_í•´ê²°_ê°€ì´ë“œ.md # JSON íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
â”‚
â””â”€â”€ ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
    â”œâ”€â”€ cleanup_orphan_data.py      # ê³ ì•„ ë°ì´í„° ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸
    â”œâ”€â”€ migrate_db.py               # ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
    â”œâ”€â”€ check_text_format.py        # ChromaDB í…ìŠ¤íŠ¸ í˜•ì‹ í™•ì¸
    â”œâ”€â”€ chatbot_test.py             # ì±—ë´‡ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
    â”œâ”€â”€ summarizer.py               # ìš”ì•½ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
    â””â”€â”€ resolve_conflicts.py        # ì¶©ëŒ í•´ê²° ìŠ¤í¬ë¦½íŠ¸
```

---

# 2. ì½”ë“œ ì•„í‚¤í…ì²˜

## 2.1 ì „ì²´ ì•„í‚¤í…ì²˜ íŒ¨í„´

GenMinuteëŠ” **3ê³„ì¸µ ì•„í‚¤í…ì²˜**ë¥¼ ë”°ë¦…ë‹ˆë‹¤:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Presentation Layer                     â”‚
â”‚  (templates/ + static/js + static/css)              â”‚
â”‚  - Jinja2 í…œí”Œë¦¿                                     â”‚
â”‚  - Vanilla JavaScript (ES6+)                        â”‚
â”‚  - CSS3 (Flexbox, Grid)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ HTTP/JSON
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Application Layer                      â”‚
â”‚  (app.py)                                           â”‚
â”‚  - Flask ë¼ìš°íŠ¸ (40+ ì—”ë“œí¬ì¸íŠ¸)                      â”‚
â”‚  - ì„¸ì…˜ ê´€ë¦¬ (Flask Session)                         â”‚
â”‚  - ê¶Œí•œ ì²´í¬ (@login_required)                       â”‚
â”‚  - Context Processor (í…œí”Œë¦¿ ë³€ìˆ˜ ì£¼ì…)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ Function Calls
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Business Logic Layer                   â”‚
â”‚  (utils/)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ stt.py          - Gemini STT ì²˜ë¦¬           â”‚   â”‚
â”‚  â”‚ db_manager.py   - SQLite CRUD               â”‚   â”‚
â”‚  â”‚ vector_db_manager.py - ChromaDB ê´€ë¦¬        â”‚   â”‚
â”‚  â”‚ chat_manager.py - ì±—ë´‡ ë¡œì§                 â”‚   â”‚
â”‚  â”‚ firebase_auth.py - Firebase ì¸ì¦            â”‚   â”‚
â”‚  â”‚ user_manager.py - ì‚¬ìš©ì ê´€ë¦¬               â”‚   â”‚
â”‚  â”‚ analysis.py     - ë°ì´í„° ë¶„ì„               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ API Calls / SQL Queries
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Data Layer                             â”‚
â”‚  - SQLite (minute_ai.db)                            â”‚
â”‚  - ChromaDB (chroma_db/)                            â”‚
â”‚  - File System (uploads/)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

External Services:
  - Gemini 2.5 Pro (STT, ìš”ì•½)
  - Gemini 2.5 Flash (ì±—ë´‡)
  - OpenAI Embeddings (text-embedding-3-small)
  - Firebase Authentication (Google OAuth)
```

---

## 2.2 ì£¼ìš” íŒŒì¼ë³„ ì—­í• 

### ğŸ¯ **app.py** (ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜)

**ì—­í• **: Flask ì›¹ ì„œë²„, ë¼ìš°íŒ…, ì„¸ì…˜ ê´€ë¦¬

**ì£¼ìš” êµ¬ì„±**:
```python
# 1. ì´ˆê¸°í™” (1-120ì¤„)
app = Flask(__name__)
app.secret_key = os.getenv("FLASK_SECRET_KEY")

# ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
db_manager = DBManager()
vdb_manager = VectorDBManager()
stt_manager = STTManager()
chat_manager = ChatManager()

# 2. Context Processor (122-141ì¤„)
@app.context_processor
def inject_user_info():
    """ëª¨ë“  í…œí”Œë¦¿ì— ì‚¬ìš©ì ì •ë³´ ì£¼ì…"""
    return {
        'user_name': session.get('name'),
        'user_email': session.get('email'),
        'is_admin': is_admin(session.get('user_id'))
    }

# 3. ì¸ì¦ ë¼ìš°íŠ¸ (144-225ì¤„)
@app.route("/login")              # ë¡œê·¸ì¸ í˜ì´ì§€
@app.route("/api/login", POST)    # Firebase í† í° ê²€ì¦
@app.route("/api/logout", POST)   # ë¡œê·¸ì•„ì›ƒ

# 4. ë©”ì¸ ê¸°ëŠ¥ ë¼ìš°íŠ¸ (228-850ì¤„)
@app.route("/")                   # ì—…ë¡œë“œ í˜ì´ì§€
@app.route("/upload", POST)       # íŒŒì¼ ì—…ë¡œë“œ ë° STT
@app.route("/notes")              # ë…¸íŠ¸ ëª©ë¡
@app.route("/shared_notes")       # ê³µìœ ë°›ì€ ë…¸íŠ¸
@app.route("/view/<meeting_id>")  # íšŒì˜ë¡ ë·°ì–´

# 5. API ì—”ë“œí¬ì¸íŠ¸ (500-1000ì¤„)
@app.route("/api/meeting/<meeting_id>")        # íšŒì˜ ë°ì´í„°
@app.route("/api/summarize/<meeting_id>", POST)# ìš”ì•½ ìƒì„±
@app.route("/api/generate_minutes", POST)      # íšŒì˜ë¡ ìƒì„±
@app.route("/api/chat", POST)                  # ì±—ë´‡
@app.route("/api/delete_meeting", POST)        # ì‚­ì œ

# 6. ê³µìœ  ê¸°ëŠ¥ (912-990ì¤„)
@app.route("/api/share/<meeting_id>", POST)
@app.route("/api/unshare/<meeting_id>/<user_id>", POST)
```

**í•µì‹¬ í•¨ìˆ˜**:
- `convert_video_to_audio()`: MP4 â†’ WAV ë³€í™˜ (ffmpeg)
- `allowed_file()`: íŒŒì¼ í™•ì¥ì ê²€ì¦
- `is_allowed_to_access()`: ê¶Œí•œ ì²´í¬ (deprecated, user_managerë¡œ ì´ë™)

---

### ğŸ“ **utils/stt.py** (STT & AI ì²˜ë¦¬)

**ì—­í• **: Gemini APIë¥¼ ì´ìš©í•œ ìŒì„± ì¸ì‹ ë° í…ìŠ¤íŠ¸ ì²˜ë¦¬

**í´ë˜ìŠ¤**: `STTManager`

**ì£¼ìš” ë©”ì„œë“œ**:
```python
class STTManager:
    def __init__(self):
        self.gemini_client = genai.Client(api_key=GOOGLE_API_KEY)
        self.model_name = "gemini-2.5-pro"

    def transcribe_audio(self, audio_file_path: str) -> list:
        """
        ìŒì„± íŒŒì¼ â†’ í…ìŠ¤íŠ¸ ë³€í™˜ + í™”ì ë¶„ë¦¬

        Returns:
            [
                {
                    "speaker": "SPEAKER_00",
                    "start_time": 0.0,
                    "segment": "ì•ˆë…•í•˜ì„¸ìš”...",
                    "confidence": 0.95
                },
                ...
            ]
        """
        # 1. íŒŒì¼ ì½ê¸° (binary)
        # 2. Gemini API í˜¸ì¶œ (ë©€í‹°ëª¨ë‹¬)
        # 3. JSON ì‘ë‹µ íŒŒì‹±
        # 4. ì •ê·œí™” (í™”ì ë ˆì´ë¸”, íƒ€ì„ìŠ¤íƒ¬í”„)

    def subtopic_generate(self, title: str, transcript_text: str) -> list:
        """
        ì†Œì£¼ì œë³„ ìš”ì•½ ìƒì„±

        Returns:
            [
                {
                    "main_topic": "í”„ë¡œì íŠ¸ ì¼ì •",
                    "subtitle": "ë§ˆì¼ìŠ¤í†¤ ë° ë°ë“œë¼ì¸",
                    "content": "* 1ì°¨: 2ì›” 1ì¼ [cite: 1]..."
                },
                ...
            ]
        """
        # 1. í”„ë¡¬í”„íŠ¸ ìƒì„± (9ê°€ì§€ ê·œì¹™)
        # 2. Gemini API í˜¸ì¶œ
        # 3. JSON íŒŒì‹±
        # 4. [cite: N] ì¸ìš© í¬í•¨

    def generate_minutes(self, chunks: list) -> str:
        """
        êµ¬ì¡°í™”ëœ íšŒì˜ë¡ ìƒì„± (RAG ê¸°ë°˜)

        Returns: ë§ˆí¬ë‹¤ìš´ í˜•ì‹ íšŒì˜ë¡
        """
        # 1. RAGë¡œ ê´€ë ¨ ì²­í¬ ê²€ìƒ‰
        # 2. ì»¨í…ìŠ¤íŠ¸ ìƒì„±
        # 3. Geminiì—ê²Œ íšŒì˜ë¡ ì‘ì„± ìš”ì²­
```

**í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§**:
- STT: 13ê°€ì§€ ê·œì¹™ (í™”ì ë³‘í•©, íƒ€ì„ìŠ¤íƒ¬í”„, JSON í˜•ì‹ ë“±)
- ìš”ì•½: 9ê°€ì§€ ê·œì¹™ (ì¸ìš© í‘œì‹œ, ì£¼ì œ ë¶„ë¥˜, ê¸€ë¨¸ë¦¬ ê¸°í˜¸ ë“±)
- íšŒì˜ë¡: êµ¬ì¡°í™” ê·œì¹™ (ì œëª©, ì•ˆê±´, ê²°ì •ì‚¬í•­, ì•¡ì…˜ ì•„ì´í…œ)

---

### ğŸ’¾ **utils/db_manager.py** (SQLite ê´€ë¦¬)

**ì—­í• **: SQLite ë°ì´í„°ë² ì´ìŠ¤ CRUD ì‘ì—…

**í´ë˜ìŠ¤**: `DBManager`

**ì£¼ìš” ë©”ì„œë“œ**:
```python
class DBManager:
    def __init__(self, db_path="database/minute_ai.db"):
        self.db_path = db_path
        self._initialize_db()  # í…Œì´ë¸” ìƒì„±

    def save_stt_to_db(self, segments, audio_filename, title,
                       meeting_date=None, owner_id=None) -> str:
        """
        STT ê²°ê³¼ë¥¼ meeting_dialogues í…Œì´ë¸”ì— ì €ì¥

        Returns: meeting_id (UUID)
        """
        meeting_id = str(uuid.uuid4())
        # INSERT INTO meeting_dialogues VALUES (...)
        return meeting_id

    def get_segments_by_meeting_id(self, meeting_id: str) -> list:
        """íšŒì˜ IDë¡œ ëª¨ë“  ëŒ€í™” ì¡°íšŒ"""
        # SELECT * FROM meeting_dialogues WHERE meeting_id = ?

    def save_minutes(self, meeting_id, title, meeting_date,
                     minutes_content, owner_id=None):
        """íšŒì˜ë¡ ì €ì¥ (INSERT or REPLACE)"""
        # INSERT OR REPLACE INTO meeting_minutes

    def get_minutes_by_id(self, meeting_id: str) -> dict:
        """íšŒì˜ë¡ ì¡°íšŒ"""
        # SELECT * FROM meeting_minutes WHERE meeting_id = ?

    def delete_meeting_by_id(self, meeting_id: str):
        """
        íšŒì˜ ë°ì´í„° ì‚­ì œ (SQLite ë¶€ë¶„)
        - meeting_dialogues ì‚­ì œ
        - meeting_minutes ì‚­ì œ
        - ì‚­ì œ ê²€ì¦ ë¡œê·¸ ì¶œë ¥
        """

    def get_all_meetings(self, owner_id: int = None) -> list:
        """
        ëª¨ë“  íšŒì˜ ëª©ë¡ ì¡°íšŒ (ê¶Œí•œ ê¸°ë°˜)
        - Admin: ëª¨ë“  íšŒì˜
        - User: ë³¸ì¸ íšŒì˜ë§Œ
        """
```

**ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”**:
```python
def _initialize_db(self):
    """
    í…Œì´ë¸” ìƒì„±:
    - users (id, google_id, email, name, role, profile_picture)
    - meeting_dialogues (id, meeting_id, speaker_label, segment, ...)
    - meeting_minutes (meeting_id, title, minutes_content, ...)
    - meeting_shares (id, meeting_id, owner_id, shared_with_id)
    """
```

---

### ğŸ—‚ï¸ **utils/vector_db_manager.py** (ChromaDB ê´€ë¦¬)

**ì—­í• **: ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ (ChromaDB) ê´€ë¦¬, RAG ê²€ìƒ‰

**í´ë˜ìŠ¤**: `VectorDBManager`

**ì£¼ìš” ë©”ì„œë“œ**:
```python
class VectorDBManager:
    def __init__(self, db_manager, persist_directory="./chroma_db"):
        self.client = chromadb.PersistentClient(path=persist_directory)
        self.embedding = OpenAIEmbeddings(model="text-embedding-3-small")

        # 2ê°œ ì»¬ë ‰ì…˜ ìƒì„±
        self.chunk_collection = self.client.get_or_create_collection("meeting_chunk")
        self.subtopic_collection = self.client.get_or_create_collection("meeting_subtopic")

    def add_meeting_as_chunk(self, meeting_id, title, meeting_date,
                             audio_file, segments: list):
        """
        Smart Chunkingìœ¼ë¡œ ëŒ€í™”ë¥¼ ì˜ë¯¸ ë‹¨ìœ„ë¡œ ë¶„í•  í›„ ì €ì¥

        ì²­í‚¹ ê·œì¹™:
        - í™”ì ë³€ê²½ ì‹œ ë¶„í• 
        - 30ì´ˆ ê²½ê³¼ ì‹œ ë¶„í• 
        - ë¬¸ë§¥ ìœ ì§€
        """
        chunks = self._create_smart_chunks(segments)

        for chunk in chunks:
            self.chunk_collection.add(
                documents=[chunk['text']],
                metadatas=[{
                    "meeting_id": meeting_id,
                    "title": title,
                    "start_time": chunk['start_time'],
                    "end_time": chunk['end_time'],
                    "speaker_count": chunk['speaker_count']
                }],
                ids=[f"{meeting_id}_chunk_{i}"]
            )

    def add_meeting_subtopic(self, meeting_id, title, meeting_date,
                             subtopics: list):
        """ì†Œì£¼ì œë³„ ìš”ì•½ì„ subtopic ì»¬ë ‰ì…˜ì— ì €ì¥"""
        for idx, subtopic in enumerate(subtopics):
            self.subtopic_collection.add(
                documents=[subtopic['content']],
                metadatas=[{
                    "meeting_id": meeting_id,
                    "meeting_title": title,
                    "main_topic": subtopic['main_topic'],
                    "subtitle": subtopic['subtitle']
                }],
                ids=[f"{meeting_id}_subtopic_{idx}"]
            )

    def search(self, db_type: str, query: str, k: int = 5,
               retriever_type: str = "self_query",
               filter_criteria: dict = None) -> list:
        """
        4ê°€ì§€ Retriever ì§€ì›:
        1. basic: ê¸°ë³¸ ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰
        2. mmr: Maximal Marginal Relevance (ë‹¤ì–‘ì„±)
        3. similarity_score_threshold: ìœ ì‚¬ë„ ì„ê³„ê°’
        4. self_query: ìì—°ì–´ â†’ ë©”íƒ€ë°ì´í„° í•„í„° (ê¸°ë³¸ê°’)

        Returns: LangChain Document ë¦¬ìŠ¤íŠ¸
        """

    def _delete_all_meeting_data(self, meeting_id: str):
        """
        meeting_idë¡œ ëª¨ë“  ë°ì´í„° ì‚­ì œ (Vector DB + SQLite + íŒŒì¼)

        ì‚­ì œ ìˆœì„œ:
        1. SQLite ì¡°íšŒ ì‹¤íŒ¨ ì‹œ Vector DBì—ì„œ audio_file ì¡°íšŒ (í´ë°±)
        2. meeting_chunk ì»¬ë ‰ì…˜ ì‚­ì œ
        3. meeting_subtopic ì»¬ë ‰ì…˜ ì‚­ì œ
        4. SQLite DB ì‚­ì œ (db_manager í˜¸ì¶œ)
        5. ì˜¤ë””ì˜¤ íŒŒì¼ ì‚­ì œ (uploads/)
        6. ê° ë‹¨ê³„ë§ˆë‹¤ ê²€ì¦ ë¡œê·¸ ì¶œë ¥
        """
```

**Smart Chunking ì•Œê³ ë¦¬ì¦˜**:
```python
def _create_smart_chunks(self, segments: list) -> list:
    """
    ì˜ë¯¸ì  ì²­í‚¹ (Semantic Chunking)

    ë¶„í•  ì¡°ê±´:
    1. í™”ìê°€ ë³€ê²½ëœ ê²½ìš°
    2. ì´ì „ ì²­í¬ ì‹œì‘ í›„ 30ì´ˆ ê²½ê³¼
    3. ë¬¸ì¥ì´ 10ê°œ ì´ìƒì¸ ê²½ìš°

    ë³‘í•© ì¡°ê±´:
    - ê°™ì€ í™”ìì˜ ì—°ì† ë°œí™”
    - 30ì´ˆ ì´ë‚´
    """
    chunks = []
    current_chunk = []
    prev_speaker = None
    chunk_start_time = 0

    for seg in segments:
        if seg['speaker'] != prev_speaker or \
           (seg['start_time'] - chunk_start_time > 30):
            if current_chunk:
                chunks.append(self._merge_segments(current_chunk))
            current_chunk = [seg]
            prev_speaker = seg['speaker']
            chunk_start_time = seg['start_time']
        else:
            current_chunk.append(seg)

    return chunks
```

---

### ğŸ’¬ **utils/chat_manager.py** (ì±—ë´‡ ë¡œì§)

**ì—­í• **: AI ì±—ë´‡ ì§ˆì˜ì‘ë‹µ ì²˜ë¦¬ (Self-Query Retriever ê¸°ë°˜)

**í´ë˜ìŠ¤**: `ChatManager`

**ì£¼ìš” ë©”ì„œë“œ**:
```python
class ChatManager:
    def __init__(self, vector_db_manager):
        self.vdb_manager = vector_db_manager
        self.gemini_client = genai.Client(api_key=GOOGLE_API_KEY)
        self.model_name = "gemini-2.5-flash"

    def search_documents(self, query: str, meeting_id: str = None,
                         accessible_meeting_ids: list = None) -> dict:
        """
        ê´€ë ¨ ë¬¸ì„œ ê²€ìƒ‰ (2ë‹¨ê³„)

        1. Chunk ê²€ìƒ‰ (ì‹¤ì œ ëŒ€í™” ì›ë¬¸) - ìƒìœ„ 3ê°œ
        2. Subtopic ê²€ìƒ‰ (ìš”ì•½ë³¸) - ìƒìœ„ 3ê°œ

        ê¶Œí•œ ì²´í¬:
        - meeting_id ìˆìŒ: í•´ë‹¹ ë…¸íŠ¸ë§Œ (ê¶Œí•œ ê²€ì¦ í•„ìˆ˜)
        - meeting_id ì—†ìŒ: ì ‘ê·¼ ê°€ëŠ¥í•œ ëª¨ë“  ë…¸íŠ¸

        Returns:
            {
                "chunks": [Document, ...],
                "subtopics": [Document, ...],
                "total_count": 6
            }
        """

    def format_context(self, search_results: dict) -> str:
        """
        ê²€ìƒ‰ëœ ë¬¸ì„œë¥¼ Geminiìš© ì»¨í…ìŠ¤íŠ¸ë¡œ í¬ë§·íŒ…

        ì¶œë ¥ í˜•ì‹:
        ```
        === íšŒì˜ ëŒ€í™” ë‚´ìš© ===
        [ë¬¸ì„œ 1]
        íšŒì˜: í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„
        ì¼ì‹œ: 2025-01-05
        ì‹œê°„: 120-180ì´ˆ
        ë‚´ìš©: ...

        === íšŒì˜ ì£¼ì œë³„ ìš”ì•½ ===
        [ìš”ì•½ 1]
        íšŒì˜: í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„
        ì£¼ì œ: ì¼ì • ë° ë§ˆì¼ìŠ¤í†¤
        ë‚´ìš©: ...
        ```
        """

    def generate_answer(self, query: str, context: str) -> dict:
        """
        Gemini 2.5 Flashë¡œ ë‹µë³€ ìƒì„±

        í”„ë¡¬í”„íŠ¸ ê·œì¹™:
        1. ì»¨í…ìŠ¤íŠ¸ ì•ˆì—ì„œë§Œ ë‹µë³€
        2. ì •ë³´ ì—†ìœ¼ë©´ "ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" ëª…ì‹œ
        3. ì‚¬ì „ ì§€ì‹ ì‚¬ìš© ê¸ˆì§€

        Returns:
            {
                "success": True,
                "answer": "ë‹µë³€ ë‚´ìš©..."
            }
        """

    def process_query(self, query: str, meeting_id: str = None,
                      accessible_meeting_ids: list = None) -> dict:
        """
        ì „ì²´ ì±—ë´‡ íŒŒì´í”„ë¼ì¸

        1. ë¬¸ì„œ ê²€ìƒ‰ (search_documents)
        2. ì»¨í…ìŠ¤íŠ¸ í¬ë§·íŒ… (format_context)
        3. ë‹µë³€ ìƒì„± (generate_answer)
        4. ì¶œì²˜ ì •ë³´ ì¶”ê°€

        Returns:
            {
                "success": True,
                "answer": "...",
                "sources": [
                    {
                        "type": "chunk",
                        "meeting_id": "...",
                        "title": "...",
                        "start_time": 120
                    }
                ]
            }
        """
```

---

### ğŸ” **utils/firebase_auth.py** (Firebase ì¸ì¦)

**ì—­í• **: Firebase ID í† í° ê²€ì¦

**ì£¼ìš” í•¨ìˆ˜**:
```python
# Firebase Admin SDK ì´ˆê¸°í™”
firebase_admin.initialize_app(cred)

def verify_id_token(id_token: str) -> dict:
    """
    Firebase ID í† í° ê²€ì¦

    Args:
        id_token: í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°›ì€ ID í† í°

    Returns:
        {
            "uid": "firebase_user_id",
            "email": "user@example.com",
            "name": "ì‚¬ìš©ìëª…",
            "picture": "https://..."
        }

    Raises:
        Exception: í† í°ì´ ìœ íš¨í•˜ì§€ ì•Šì€ ê²½ìš°
    """
    try:
        decoded_token = auth.verify_id_token(id_token)
        return {
            "uid": decoded_token['uid'],
            "email": decoded_token.get('email'),
            "name": decoded_token.get('name'),
            "picture": decoded_token.get('picture')
        }
    except Exception as e:
        print(f"âŒ í† í° ê²€ì¦ ì‹¤íŒ¨: {e}")
        return None
```

---

### ğŸ‘¤ **utils/user_manager.py** (ì‚¬ìš©ì ê´€ë¦¬)

**ì—­í• **: ì‚¬ìš©ì CRUD, ê¶Œí•œ ê´€ë¦¬, ê³µìœ  ê¸°ëŠ¥

**ì£¼ìš” í•¨ìˆ˜**:
```python
def get_or_create_user(google_id, email, name=None, profile_picture=None):
    """
    ì‚¬ìš©ì ì¡°íšŒ ë˜ëŠ” ìƒì„± (ë¡œê·¸ì¸ ì‹œ í˜¸ì¶œ)

    Returns:
        {
            "id": 1,
            "google_id": "...",
            "email": "user@example.com",
            "name": "...",
            "role": "user",
            "profile_picture": "..."
        }
    """

def can_access_meeting(user_id: int, meeting_id: str) -> bool:
    """
    íšŒì˜ ì ‘ê·¼ ê¶Œí•œ ì²´í¬

    ì¡°ê±´:
    1. ë³¸ì¸ì´ ìƒì„±í•œ ë…¸íŠ¸
    2. ê³µìœ ë°›ì€ ë…¸íŠ¸
    3. Adminì¸ ê²½ìš° ëª¨ë“  ë…¸íŠ¸
    """

def share_meeting(owner_id: int, meeting_id: str,
                  shared_with_email: str) -> dict:
    """
    ë…¸íŠ¸ ê³µìœ 

    1. ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ì¡°íšŒ
    2. meeting_shares í…Œì´ë¸”ì— INSERT
    3. ì¤‘ë³µ ê³µìœ  ë°©ì§€ (UNIQUE ì œì•½)
    """

def get_user_accessible_meeting_ids(user_id: int) -> list:
    """
    ì‚¬ìš©ìê°€ ì ‘ê·¼ ê°€ëŠ¥í•œ ëª¨ë“  meeting_id ëª©ë¡

    SQL:
    SELECT DISTINCT meeting_id
    FROM meeting_dialogues
    LEFT JOIN meeting_shares ON ...
    WHERE owner_id = ? OR shared_with_id = ?
    """

def get_user_meetings(user_id: int) -> list:
    """
    ì‚¬ìš©ìì˜ ë³¸ì¸ ë…¸íŠ¸ ëª©ë¡ (ê³µìœ ë°›ì€ ë…¸íŠ¸ ì œì™¸)
    """

def get_shared_meetings(user_id: int) -> list:
    """
    ì‚¬ìš©ìê°€ ê³µìœ ë°›ì€ ë…¸íŠ¸ ëª©ë¡ (ë³¸ì¸ ë…¸íŠ¸ ì œì™¸)
    """

def is_admin(user_id: int) -> bool:
    """
    ê´€ë¦¬ì ì²´í¬ (í•˜ë“œì½”ë”©ëœ ì´ë©”ì¼ ëª©ë¡)

    ADMIN_EMAILS = [
        "admin@example.com",
        ...
    ]
    """
```

---

### ğŸ›¡ï¸ **utils/decorators.py** (ì¸ì¦ ë°ì½”ë ˆì´í„°)

**ì—­í• **: Flask ë¼ìš°íŠ¸ ë³´í˜¸

**ë°ì½”ë ˆì´í„°**:
```python
def login_required(f):
    """
    ë¡œê·¸ì¸ í•„ìˆ˜ ë°ì½”ë ˆì´í„°

    ì‚¬ìš©ë²•:
    @app.route("/protected")
    @login_required
    def protected_route():
        ...

    ë™ì‘:
    - sessionì— user_id ì—†ìœ¼ë©´ /loginìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    """
    @wraps(f)
    def decorated_function(*args, **kwargs):
        if 'user_id' not in session:
            return redirect(url_for('login_page'))
        return f(*args, **kwargs)
    return decorated_function

def admin_required(f):
    """
    ê´€ë¦¬ì ì „ìš© ë°ì½”ë ˆì´í„°

    ì‚¬ìš©ë²•:
    @app.route("/admin/panel")
    @login_required
    @admin_required
    def admin_panel():
        ...
    """
    @wraps(f)
    def decorated_function(*args, **kwargs):
        user_id = session.get('user_id')
        if not is_admin(user_id):
            return jsonify({"error": "ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤."}), 403
        return f(*args, **kwargs)
    return decorated_function
```

---

### ğŸ“Š **utils/analysis.py** (ë°ì´í„° ë¶„ì„)

**ì—­í• **: í™”ìë³„ í†µê³„ ë¶„ì„

**ì£¼ìš” í•¨ìˆ˜**:
```python
def calculate_speaker_share(segments: list) -> list:
    """
    í™”ìë³„ ë°œí™” ì‹œê°„ ë¹„ìœ¨ ê³„ì‚°

    Args:
        segments: [{speaker, start_time, segment}, ...]

    Returns:
        [
            {
                "speaker": "SPEAKER_00",
                "duration": 180.5,  # ì´ˆ
                "percentage": 35.2  # %
            },
            ...
        ]

    ì•Œê³ ë¦¬ì¦˜:
    1. ê° ì„¸ê·¸ë¨¼íŠ¸ì˜ duration = ë‹¤ìŒ start_time - í˜„ì¬ start_time
    2. í™”ìë³„ë¡œ duration í•©ì‚°
    3. ì „ì²´ ì‹œê°„ ëŒ€ë¹„ ë¹„ìœ¨ ê³„ì‚°
    """
```

---

# 3. ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

## 3.1 SQLite Database (`minute_ai.db`)

### ğŸ“‹ ER Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚â—„â”€â”€â”€â”€â”
â”‚ google_id       â”‚     â”‚
â”‚ email           â”‚     â”‚
â”‚ name            â”‚     â”‚
â”‚ role            â”‚     â”‚ 1
â”‚ profile_picture â”‚     â”‚
â”‚ created_at      â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                        â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚             â”‚             â”‚
          â”‚ *           â”‚ *           â”‚ *
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚meeting_dialogues â”‚ â”‚meeting_minutes  â”‚ â”‚meeting_shares â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)          â”‚ â”‚ meeting_id (PK) â”‚ â”‚ id (PK)       â”‚
â”‚ meeting_id       â”‚ â”‚ title           â”‚ â”‚ meeting_id    â”‚
â”‚ meeting_date     â”‚ â”‚ meeting_date    â”‚ â”‚ owner_id (FK) â”‚
â”‚ speaker_label    â”‚ â”‚ minutes_content â”‚ â”‚ shared_with_idâ”‚
â”‚ start_time       â”‚ â”‚ created_at      â”‚ â”‚ shared_at     â”‚
â”‚ segment          â”‚ â”‚ updated_at      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ confidence       â”‚ â”‚ owner_id (FK)   â”‚
â”‚ audio_file       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ title            â”‚
â”‚ owner_id (FK)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### í…Œì´ë¸” ìƒì„¸

#### 1ï¸âƒ£ **users** (ì‚¬ìš©ì ì •ë³´)

```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    google_id TEXT UNIQUE NOT NULL,     -- Firebase UID
    email TEXT UNIQUE NOT NULL,
    name TEXT,
    profile_picture TEXT,               -- í”„ë¡œí•„ ì‚¬ì§„ URL
    role TEXT DEFAULT 'user',           -- 'user' or 'admin'
    created_at TEXT NOT NULL
);
```

**ì¸ë±ìŠ¤**:
```sql
CREATE INDEX idx_users_google_id ON users(google_id);
CREATE INDEX idx_users_email ON users(email);
```

**ìƒ˜í”Œ ë°ì´í„°**:
| id | google_id | email | name | role |
|----|-----------|-------|------|------|
| 1 | abc123 | admin@example.com | ê´€ë¦¬ì | admin |
| 2 | def456 | user@example.com | ì‚¬ìš©ì | user |

---

#### 2ï¸âƒ£ **meeting_dialogues** (ëŒ€í™” ì›ë³¸)

```sql
CREATE TABLE meeting_dialogues (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    meeting_id TEXT NOT NULL,           -- UUID (íšŒì˜ ê³ ìœ  ID)
    meeting_date DATETIME NOT NULL,
    speaker_label TEXT NOT NULL,        -- SPEAKER_00, SPEAKER_01, ...
    start_time REAL NOT NULL,           -- ì´ˆ ë‹¨ìœ„
    segment TEXT NOT NULL,              -- ë°œí™” ë‚´ìš©
    confidence REAL,                    -- STT ì‹ ë¢°ë„ (0.0-1.0)
    audio_file TEXT NOT NULL,           -- ì›ë³¸ íŒŒì¼ëª…
    title TEXT NOT NULL,                -- íšŒì˜ ì œëª©
    owner_id INTEGER,                   -- ìƒì„±ì (FK â†’ users.id)
    FOREIGN KEY (owner_id) REFERENCES users(id)
);
```

**ì¸ë±ìŠ¤**:
```sql
CREATE INDEX idx_dialogues_meeting_id ON meeting_dialogues(meeting_id);
CREATE INDEX idx_dialogues_owner_id ON meeting_dialogues(owner_id);
```

**ìƒ˜í”Œ ë°ì´í„°**:
| id | meeting_id | speaker_label | start_time | segment | owner_id |
|----|------------|---------------|------------|---------|----------|
| 1 | uuid-123 | SPEAKER_00 | 0.0 | ì•ˆë…•í•˜ì„¸ìš” | 1 |
| 2 | uuid-123 | SPEAKER_01 | 5.2 | ë„¤ ì €ëŠ”... | 1 |

**íŠ¹ì§•**:
- meeting_idëŠ” UUID í˜•ì‹ (ì˜ˆ: `a1b2c3d4-5e6f-...`)
- í•œ íšŒì˜ë‹¹ ìˆ˜ë°±~ìˆ˜ì²œ ê°œì˜ í–‰ ìƒì„±
- **ì‚­ì œ í‚¤ê°’**: meeting_idë¡œ ì¼ê´„ ì‚­ì œ

---

#### 3ï¸âƒ£ **meeting_minutes** (íšŒì˜ë¡)

```sql
CREATE TABLE meeting_minutes (
    meeting_id TEXT PRIMARY KEY,        -- UUID
    title TEXT NOT NULL,
    meeting_date TEXT NOT NULL,
    minutes_content TEXT NOT NULL,      -- ë§ˆí¬ë‹¤ìš´ í˜•ì‹ íšŒì˜ë¡
    created_at TEXT NOT NULL,
    updated_at TEXT NOT NULL,
    owner_id INTEGER,                   -- ìƒì„±ì (FK â†’ users.id)
    FOREIGN KEY (owner_id) REFERENCES users(id)
);
```

**ì¸ë±ìŠ¤**:
```sql
CREATE INDEX idx_minutes_owner_id ON meeting_minutes(owner_id);
```

**ìƒ˜í”Œ ë°ì´í„°**:
| meeting_id | title | minutes_content | owner_id |
|------------|-------|-----------------|----------|
| uuid-123 | ì£¼ê°„ íšŒì˜ | # ì£¼ê°„ íšŒì˜\n\n... | 1 |

**íŠ¹ì§•**:
- meeting_idê°€ PK (1íšŒì˜ = 1íšŒì˜ë¡)
- INSERT OR REPLACE ë¡œì§ (ì¬ìƒì„± ê°€ëŠ¥)

---

#### 4ï¸âƒ£ **meeting_shares** (ê³µìœ  ê´€ê³„)

```sql
CREATE TABLE meeting_shares (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    meeting_id TEXT NOT NULL,
    owner_id INTEGER NOT NULL,          -- ê³µìœ í•œ ì‚¬ëŒ (FK â†’ users.id)
    shared_with_id INTEGER NOT NULL,    -- ê³µìœ ë°›ì€ ì‚¬ëŒ (FK â†’ users.id)
    shared_at TEXT NOT NULL,
    FOREIGN KEY (owner_id) REFERENCES users(id),
    FOREIGN KEY (shared_with_id) REFERENCES users(id),
    UNIQUE(meeting_id, shared_with_id)  -- ì¤‘ë³µ ê³µìœ  ë°©ì§€
);
```

**ì¸ë±ìŠ¤**:
```sql
CREATE INDEX idx_shares_meeting_id ON meeting_shares(meeting_id);
CREATE INDEX idx_shares_shared_with_id ON meeting_shares(shared_with_id);
```

**ìƒ˜í”Œ ë°ì´í„°**:
| id | meeting_id | owner_id | shared_with_id | shared_at |
|----|------------|----------|----------------|-----------|
| 1 | uuid-123 | 1 | 2 | 2025-01-05 14:30 |

**íŠ¹ì§•**:
- UNIQUE ì œì•½ìœ¼ë¡œ ì¤‘ë³µ ê³µìœ  ë°©ì§€
- ê³µìœ  í•´ì œ ì‹œ í•´ë‹¹ í–‰ DELETE

---

## 3.2 ChromaDB (ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤)

### ì»¬ë ‰ì…˜ êµ¬ì¡°

ChromaDBëŠ” **2ê°œì˜ ì»¬ë ‰ì…˜**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

```
chroma_db/
â”œâ”€â”€ meeting_chunk/          # ëŒ€í™” ì²­í¬ (Smart Chunking)
â””â”€â”€ meeting_subtopic/       # ì†Œì£¼ì œë³„ ìš”ì•½
```

---

#### 1ï¸âƒ£ **meeting_chunk** (ëŒ€í™” ì²­í¬)

**ìš©ë„**: RAG ê²€ìƒ‰, íšŒì˜ë¡ ìƒì„±

**ë°ì´í„° êµ¬ì¡°**:
```python
{
    "id": "meeting-id_chunk_0",
    "document": "SPEAKER_00: í”„ë¡œì íŠ¸ ì¼ì •ì€ 2ì›” 15ì¼ê¹Œì§€ì…ë‹ˆë‹¤...",
    "embedding": [0.123, -0.456, ...],  # 1536 ì°¨ì› ë²¡í„°
    "metadata": {
        "meeting_id": "uuid-123",
        "title": "í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„",
        "meeting_date": "2025-01-05",
        "audio_file": "meeting.wav",
        "chunk_index": 0,
        "start_time": 0.0,
        "end_time": 30.5,
        "speaker_count": 2
    }
}
```

**Embedding ëª¨ë¸**: OpenAI `text-embedding-3-small` (1536 ì°¨ì›)

**ì²­í‚¹ ì „ëµ**:
- í™”ì ë³€ê²½ ì‹œ ë¶„í• 
- 30ì´ˆ ê²½ê³¼ ì‹œ ë¶„í• 
- í‰ê·  ì²­í¬ í¬ê¸°: 200-500 ë‹¨ì–´

---

#### 2ï¸âƒ£ **meeting_subtopic** (ì†Œì£¼ì œë³„ ìš”ì•½)

**ìš©ë„**: ì±—ë´‡ ê²€ìƒ‰, ë¹ ë¥¸ íšŒì˜ ë‚´ìš© íŒŒì•…

**ë°ì´í„° êµ¬ì¡°**:
```python
{
    "id": "meeting-id_subtopic_0",
    "document": "### í”„ë¡œì íŠ¸ ì¼ì •\n* 1ì°¨: 2ì›” 1ì¼ [cite: 1]\n...",
    "embedding": [0.789, -0.321, ...],  # 1536 ì°¨ì› ë²¡í„°
    "metadata": {
        "meeting_id": "uuid-123",
        "meeting_title": "í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„",
        "meeting_date": "2025-01-05",
        "audio_file": "meeting.wav",
        "main_topic": "í”„ë¡œì íŠ¸ ì¼ì • ë° ë§ˆì¼ìŠ¤í†¤",
        "subtitle": "ë°ë“œë¼ì¸ ë° ì¤‘ê°„ ì ê²€"
    }
}
```

**íŠ¹ì§•**:
- Geminiê°€ ìƒì„±í•œ ìš”ì•½ë¬¸ ê·¸ëŒ€ë¡œ ì €ì¥
- `[cite: N]` ì¸ìš© í¬í•¨
- í‰ê·  3-10ê°œ subtopic per meeting

---

### Vector DB ê²€ìƒ‰ ë¡œì§

```python
# Self-Query Retriever ì˜ˆì‹œ
query = "í”„ë¡œì íŠ¸ ì¼ì •ì€ ì–¸ì œê¹Œì§€ì•¼?"

# 1. ìì—°ì–´ â†’ ë©”íƒ€ë°ì´í„° í•„í„° ë³€í™˜
filter = {
    "meeting_id": "uuid-123"  # íŠ¹ì • íšŒì˜ë¡œ ì œí•œ
}

# 2. ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰
results = collection.query(
    query_embeddings=[embedding_of(query)],
    where=filter,
    n_results=3
)

# 3. ê²°ê³¼ ë°˜í™˜
[
    {
        "document": "SPEAKER_00: í”„ë¡œì íŠ¸ëŠ” 2ì›” 15ì¼ê¹Œì§€...",
        "distance": 0.23,  # ë‚®ì„ìˆ˜ë¡ ìœ ì‚¬
        "metadata": {...}
    },
    ...
]
```

---

## 3.3 íŒŒì¼ ì‹œìŠ¤í…œ (uploads/)

**êµ¬ì¡°**:
```
uploads/
â”œâ”€â”€ meeting_2025-01-05_14-30.wav    # ì˜¤ë””ì˜¤ íŒŒì¼
â”œâ”€â”€ weekly_meeting.mp4              # ë¹„ë””ì˜¤ íŒŒì¼ (ì›ë³¸ ë³´ê´€)
â””â”€â”€ presentation.m4a                # M4A íŒŒì¼
```

**íŒŒì¼ëª… ê·œì¹™**: (ì‚¬ìš©ì ì…ë ¥ ì œëª© ë˜ëŠ” ì›ë³¸ íŒŒì¼ëª…)

**ì €ì¥ íë¦„**:
```
1. íŒŒì¼ ì—…ë¡œë“œ â†’ uploads/ í´ë”ì— ì €ì¥
2. MP4ì¸ ê²½ìš° â†’ ffmpegë¡œ WAV ë³€í™˜ (ì„ì‹œ íŒŒì¼)
3. STT ì²˜ë¦¬ â†’ ì„ì‹œ WAV ì‚­ì œ
4. ì›ë³¸ MP4 ìœ ì§€ (databaseì— ê²½ë¡œ ì €ì¥)
```

**ì‚­ì œ**:
- meeting_id ì‚­ì œ ì‹œ audio_fileë„ í•¨ê»˜ ì‚­ì œ
- `os.remove(audio_path)`

---

# 4. API ì—”ë“œí¬ì¸íŠ¸

## 4.1 ì¸ì¦ (Authentication)

### `GET /login`
**ì„¤ëª…**: ë¡œê·¸ì¸ í˜ì´ì§€ ë Œë”ë§
**ì¸ì¦**: ë¶ˆí•„ìš”
**ì‘ë‹µ**: HTML (login.html)

---

### `POST /api/login`
**ì„¤ëª…**: Firebase ID í† í° ê²€ì¦ ë° ì„¸ì…˜ ìƒì„±
**ì¸ì¦**: ë¶ˆí•„ìš”
**ìš”ì²­**:
```json
{
  "idToken": "firebase_id_token_string"
}
```
**ì‘ë‹µ**:
```json
{
  "success": true,
  "user": {
    "id": 1,
    "email": "user@example.com",
    "name": "ì‚¬ìš©ìëª…",
    "role": "user"
  }
}
```

---

### `POST /api/logout`
**ì„¤ëª…**: ì„¸ì…˜ ì‚­ì œ ë° ë¡œê·¸ì•„ì›ƒ
**ì¸ì¦**: ë¶ˆí•„ìš”
**ì‘ë‹µ**:
```json
{
  "success": true
}
```

---

## 4.2 íšŒì˜ ì—…ë¡œë“œ & ì²˜ë¦¬

### `GET /`
**ì„¤ëª…**: íŒŒì¼ ì—…ë¡œë“œ í˜ì´ì§€
**ì¸ì¦**: @login_required
**ì‘ë‹µ**: HTML (index.html)

---

### `POST /upload`
**ì„¤ëª…**: ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤ íŒŒì¼ ì—…ë¡œë“œ ë° STT ì²˜ë¦¬
**ì¸ì¦**: @login_required
**ìš”ì²­**: `multipart/form-data`
```
file: (binary)
title: "íšŒì˜ ì œëª©"
```
**ì²˜ë¦¬ ê³¼ì •**:
1. íŒŒì¼ ì €ì¥ (uploads/)
2. MP4 â†’ WAV ë³€í™˜ (í•„ìš”ì‹œ)
3. Gemini STT ì²˜ë¦¬
4. SQLite ì €ì¥ (meeting_dialogues)
5. Smart Chunking â†’ ChromaDB ì €ì¥
6. ì†Œì£¼ì œë³„ ìš”ì•½ ìƒì„± â†’ ChromaDB ì €ì¥

**ì‘ë‹µ**:
```json
{
  "success": true,
  "meeting_id": "uuid-123",
  "redirect": "/view/uuid-123"
}
```

---

## 4.3 íšŒì˜ ì¡°íšŒ

### `GET /notes`
**ì„¤ëª…**: ë³¸ì¸ì´ ìƒì„±í•œ ë…¸íŠ¸ ëª©ë¡
**ì¸ì¦**: @login_required
**ì‘ë‹µ**: HTML (notes.html)

---

### `GET /shared_notes`
**ì„¤ëª…**: ê³µìœ ë°›ì€ ë…¸íŠ¸ ëª©ë¡
**ì¸ì¦**: @login_required
**ì‘ë‹µ**: HTML (shared_notes.html)

---

### `GET /view/<meeting_id>`
**ì„¤ëª…**: íšŒì˜ë¡ ë·°ì–´ í˜ì´ì§€
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬
**ì‘ë‹µ**: HTML (viewer.html)

---

### `GET /api/meeting/<meeting_id>`
**ì„¤ëª…**: íšŒì˜ ë°ì´í„° ì¡°íšŒ (ëŒ€í™”ë¡, ìš”ì•½, ì°¸ì„ì)
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬
**ì‘ë‹µ**:
```json
{
  "title": "í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„",
  "meeting_date": "2025-01-05 14:00",
  "transcript": [
    {
      "id": 1,
      "speaker_label": "SPEAKER_00",
      "start_time": 0.0,
      "segment": "ì•ˆë…•í•˜ì„¸ìš”"
    }
  ],
  "participants": ["SPEAKER_00", "SPEAKER_01"],
  "speaker_share": [
    {
      "speaker": "SPEAKER_00",
      "duration": 180.5,
      "percentage": 35.2
    }
  ]
}
```

---

## 4.4 ìš”ì•½ & íšŒì˜ë¡

### `POST /api/summarize/<meeting_id>`
**ì„¤ëª…**: ì†Œì£¼ì œë³„ ìš”ì•½ ì¡°íšŒ (ì´ë¯¸ ìƒì„±ë¨, DBì—ì„œ ì¡°íšŒë§Œ)
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬
**ì‘ë‹µ**:
```json
{
  "success": true,
  "summaries": [
    {
      "main_topic": "í”„ë¡œì íŠ¸ ì¼ì •",
      "subtitle": "ë§ˆì¼ìŠ¤í†¤",
      "content": "* 1ì°¨: 2ì›” 1ì¼ [cite: 1]"
    }
  ]
}
```

---

### `GET /api/check_summary/<meeting_id>`
**ì„¤ëª…**: ìš”ì•½ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬
**ì‘ë‹µ**:
```json
{
  "exists": true
}
```

---

### `POST /api/generate_minutes/<meeting_id>`
**ì„¤ëª…**: êµ¬ì¡°í™”ëœ íšŒì˜ë¡ ìƒì„±
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬
**ì²˜ë¦¬**: RAGë¡œ ì²­í¬ ê²€ìƒ‰ â†’ Geminië¡œ íšŒì˜ë¡ ì‘ì„±
**ì‘ë‹µ**:
```json
{
  "success": true,
  "minutes": "# í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„ íšŒì˜\n\n## ì£¼ìš” ì•ˆê±´\n..."
}
```

---

### `GET /api/get_minutes/<meeting_id>`
**ì„¤ëª…**: ì €ì¥ëœ íšŒì˜ë¡ ì¡°íšŒ
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬
**ì‘ë‹µ**:
```json
{
  "success": true,
  "minutes": "# í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„ íšŒì˜\n..."
}
```

---

## 4.5 ì±—ë´‡

### `POST /api/chat`
**ì„¤ëª…**: AI ì±—ë´‡ ì§ˆì˜ì‘ë‹µ
**ì¸ì¦**: @login_required
**ìš”ì²­**:
```json
{
  "query": "í”„ë¡œì íŠ¸ ì¼ì •ì€ ì–¸ì œê¹Œì§€ì•¼?",
  "meeting_id": "uuid-123"  // optional, ì—†ìœ¼ë©´ ì „ì²´ ë…¸íŠ¸ ê²€ìƒ‰
}
```
**ì‘ë‹µ**:
```json
{
  "success": true,
  "answer": "í”„ë¡œì íŠ¸ëŠ” 2ì›” 15ì¼ê¹Œì§€ ì™„ë£Œí•´ì•¼ í•©ë‹ˆë‹¤.",
  "sources": [
    {
      "type": "chunk",
      "meeting_id": "uuid-123",
      "title": "í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„",
      "start_time": 120,
      "end_time": 180
    }
  ]
}
```

---

## 4.6 ì‚­ì œ

### `POST /api/delete_meeting/<meeting_id>`
**ì„¤ëª…**: íšŒì˜ ë°ì´í„° ì „ì²´ ì‚­ì œ
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬ (ì†Œìœ ìë§Œ)
**ì‚­ì œ ëŒ€ìƒ**:
- SQLite (meeting_dialogues, meeting_minutes)
- ChromaDB (meeting_chunk, meeting_subtopic)
- íŒŒì¼ ì‹œìŠ¤í…œ (uploads/)

**ì‘ë‹µ**:
```json
{
  "success": true,
  "message": "íšŒì˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

**í„°ë¯¸ë„ ë¡œê·¸**:
```
======================================================================
ğŸ—‘ï¸  [íšŒì˜ ë°ì´í„° ì‚­ì œ í”„ë¡œì„¸ìŠ¤ ì‹œì‘]
======================================================================
ğŸ”‘ ì‚­ì œ í‚¤ê°’(meeting_id): uuid-123
...
ğŸ‰ [ì‚­ì œ ì‘ì—… ìµœì¢… ìš”ì•½]
âœ“ SQLite meeting_dialogues: 150ê°œ ì‚­ì œ
âœ“ SQLite meeting_minutes: 1ê°œ ì‚­ì œ
âœ“ Vector DB meeting_chunk: 20ê°œ ì‚­ì œ
âœ“ Vector DB meeting_subtopic: 5ê°œ ì‚­ì œ
âœ“ ì˜¤ë””ì˜¤ íŒŒì¼: ì‚­ì œë¨
======================================================================
```

---

## 4.7 ê³µìœ 

### `POST /api/share/<meeting_id>`
**ì„¤ëª…**: ë…¸íŠ¸ ê³µìœ  (ì´ë©”ì¼ ê¸°ë°˜)
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬ (ì†Œìœ ìë§Œ)
**ìš”ì²­**:
```json
{
  "email": "colleague@example.com"
}
```
**ì‘ë‹µ**:
```json
{
  "success": true,
  "message": "colleague@example.comë‹˜ê³¼ ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

---

### `GET /api/shared_users/<meeting_id>`
**ì„¤ëª…**: ê³µìœ ë°›ì€ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬
**ì‘ë‹µ**:
```json
{
  "success": true,
  "shared_users": [
    {
      "user_id": 2,
      "email": "colleague@example.com",
      "name": "ë™ë£Œ",
      "shared_at": "2025-01-05 15:00"
    }
  ]
}
```

---

### `POST /api/unshare/<meeting_id>/<user_id>`
**ì„¤ëª…**: ê³µìœ  í•´ì œ
**ì¸ì¦**: @login_required + ê¶Œí•œ ì²´í¬ (ì†Œìœ ìë§Œ)
**ì‘ë‹µ**:
```json
{
  "success": true,
  "message": "ê³µìœ ê°€ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

---

## 4.8 ê²€ìƒ‰ (Admin ì „ìš©)

### `GET /retriever`
**ì„¤ëª…**: ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ (4ê°€ì§€ Retriever)
**ì¸ì¦**: @login_required + @admin_required
**ì‘ë‹µ**: HTML (retriever.html)

---

### `POST /api/search`
**ì„¤ëª…**: Vector DB ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
**ì¸ì¦**: @login_required + @admin_required
**ìš”ì²­**:
```json
{
  "db_type": "chunks",
  "query": "í”„ë¡œì íŠ¸ ì¼ì •",
  "k": 5,
  "retriever_type": "self_query",
  "filter_criteria": {
    "meeting_id": "uuid-123"
  }
}
```
**ì‘ë‹µ**:
```json
{
  "success": true,
  "results": [
    {
      "content": "SPEAKER_00: í”„ë¡œì íŠ¸ëŠ” 2ì›” 15ì¼ê¹Œì§€...",
      "metadata": {
        "meeting_id": "uuid-123",
        "start_time": 120
      }
    }
  ]
}
```

---

# 5. ì£¼ìš” í´ë˜ìŠ¤ ë° í•¨ìˆ˜

## 5.1 í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STTManager    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - gemini_client â”‚
â”‚ - model_name    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + transcribe()  â”‚
â”‚ + summarize()   â”‚
â”‚ + generate()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DBManager     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - db_path       â”‚
â”‚ - conn          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + save_stt()    â”‚
â”‚ + get_segments()â”‚
â”‚ + save_minutes()â”‚
â”‚ + delete()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VectorDBManager      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - client             â”‚
â”‚ - embedding          â”‚
â”‚ - chunk_collection   â”‚
â”‚ - subtopic_collectionâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + add_chunk()        â”‚
â”‚ + add_subtopic()     â”‚
â”‚ + search()           â”‚
â”‚ + delete()           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ChatManager    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - vdb_manager   â”‚
â”‚ - gemini_client â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + search_docs() â”‚
â”‚ + format_ctx()  â”‚
â”‚ + generate_ans()â”‚
â”‚ + process_query()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5.2 í•µì‹¬ í•¨ìˆ˜ ëª©ë¡

### app.py

| í•¨ìˆ˜ | ì—­í•  | ë¼ì¸ |
|------|------|------|
| `inject_user_info()` | Context Processor (í…œí”Œë¦¿ ë³€ìˆ˜ ì£¼ì…) | 122-141 |
| `convert_video_to_audio()` | MP4 â†’ WAV ë³€í™˜ (ffmpeg) | 74-118 |
| `allowed_file()` | íŒŒì¼ í™•ì¥ì ê²€ì¦ | 60-61 |
| `upload()` | íŒŒì¼ ì—…ë¡œë“œ ë° STT ì²˜ë¦¬ | 228-510 |
| `view_meeting()` | íšŒì˜ë¡ ë·°ì–´ ë Œë”ë§ | 512-530 |
| `api_meeting()` | íšŒì˜ ë°ì´í„° ì¡°íšŒ API | 532-585 |
| `generate_minutes_api()` | íšŒì˜ë¡ ìƒì„± API | 650-720 |
| `chat()` | ì±—ë´‡ API | 852-910 |
| `delete_meeting_api()` | ì‚­ì œ API | 750-850 |

### utils/stt.py

| í•¨ìˆ˜ | ì—­í•  | ë¼ì¸ |
|------|------|------|
| `transcribe_audio()` | STT ì²˜ë¦¬ | 28-114 |
| `subtopic_generate()` | ì†Œì£¼ì œë³„ ìš”ì•½ ìƒì„± | 154-186 |
| `generate_minutes()` | íšŒì˜ë¡ ìƒì„± (RAG) | 200-280 |

### utils/db_manager.py

| í•¨ìˆ˜ | ì—­í•  | ë¼ì¸ |
|------|------|------|
| `_initialize_db()` | í…Œì´ë¸” ìƒì„± | 15-100 |
| `save_stt_to_db()` | STT ê²°ê³¼ ì €ì¥ | 102-150 |
| `get_segments_by_meeting_id()` | ëŒ€í™” ì¡°íšŒ | 152-180 |
| `save_minutes()` | íšŒì˜ë¡ ì €ì¥ | 182-220 |
| `delete_meeting_by_id()` | íšŒì˜ ì‚­ì œ (SQLite) | 201-281 |

### utils/vector_db_manager.py

| í•¨ìˆ˜ | ì—­í•  | ë¼ì¸ |
|------|------|------|
| `add_meeting_as_chunk()` | Smart Chunking ë° ì €ì¥ | 174-252 |
| `add_meeting_subtopic()` | ìš”ì•½ ì €ì¥ | 254-300 |
| `search()` | Vector ê²€ìƒ‰ (4ê°€ì§€ Retriever) | 312-407 |
| `_create_smart_chunks()` | ì˜ë¯¸ì  ì²­í‚¹ ì•Œê³ ë¦¬ì¦˜ | 79-125 |
| `_delete_all_meeting_data()` | íšŒì˜ ì „ì²´ ì‚­ì œ (Vector + SQL + íŒŒì¼) | 612-779 |

### utils/chat_manager.py

| í•¨ìˆ˜ | ì—­í•  | ë¼ì¸ |
|------|------|------|
| `search_documents()` | ê´€ë ¨ ë¬¸ì„œ ê²€ìƒ‰ (chunk + subtopic) | 32-132 |
| `format_context()` | ì»¨í…ìŠ¤íŠ¸ í¬ë§·íŒ… | 134-175 |
| `generate_answer()` | Gemini ë‹µë³€ ìƒì„± | 177-239 |
| `process_query()` | ì „ì²´ ì±—ë´‡ íŒŒì´í”„ë¼ì¸ | 241-309 |

### utils/user_manager.py

| í•¨ìˆ˜ | ì—­í•  | ë¼ì¸ |
|------|------|------|
| `get_or_create_user()` | ì‚¬ìš©ì ì¡°íšŒ/ìƒì„± | 30-85 |
| `can_access_meeting()` | ê¶Œí•œ ì²´í¬ | 120-165 |
| `share_meeting()` | ë…¸íŠ¸ ê³µìœ  | 250-310 |
| `get_user_accessible_meeting_ids()` | ì ‘ê·¼ ê°€ëŠ¥ ë…¸íŠ¸ ëª©ë¡ | 389-426 |
| `is_admin()` | ê´€ë¦¬ì ì²´í¬ | 15-25 |

---

# 6. ë°ì´í„° íë¦„

## 6.1 ì—…ë¡œë“œë¶€í„° íšŒì˜ë¡ ìƒì„±ê¹Œì§€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ì‚¬ìš©ì íŒŒì¼ ì—…ë¡œë“œ (index.html)                        â”‚
â”‚    - File: meeting.mp4                                  â”‚
â”‚    - Title: "í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„"                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ POST /upload
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Flask ì„œë²„ (app.py:upload)                           â”‚
â”‚    - íŒŒì¼ ì €ì¥: uploads/meeting.mp4                      â”‚
â”‚    - MP4 ê°ì§€ â†’ convert_video_to_audio() í˜¸ì¶œ           â”‚
â”‚      â””â”€ ffmpeg -i meeting.mp4 temp.wav                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. STTManager.transcribe_audio(temp.wav)                â”‚
â”‚    - Gemini 2.5 Pro API í˜¸ì¶œ                            â”‚
â”‚    - ì‘ë‹µ: JSON (speaker, start_time, segment)          â”‚
â”‚    - ì •ê·œí™” ë° ê²€ì¦                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ segments = [{...}, {...}, ...]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. DBManager.save_stt_to_db(segments)                   â”‚
â”‚    - meeting_id = UUID ìƒì„±                             â”‚
â”‚    - INSERT INTO meeting_dialogues                      â”‚
â”‚    - owner_id = session['user_id']                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ meeting_id
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. VectorDBManager.add_meeting_as_chunk()               â”‚
â”‚    - Smart Chunking (í™”ì/ì‹œê°„ ê¸°ë°˜)                     â”‚
â”‚    - OpenAI Embedding ìƒì„±                              â”‚
â”‚    - ChromaDB meeting_chunkì— ì €ì¥                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. STTManager.subtopic_generate(transcript)             â”‚
â”‚    - Gemini 2.5 Proë¡œ ìš”ì•½ ìƒì„±                         â”‚
â”‚    - ì‘ë‹µ: [{main_topic, content}, ...]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ subtopics
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. VectorDBManager.add_meeting_subtopic()               â”‚
â”‚    - OpenAI Embedding ìƒì„±                              â”‚
â”‚    - ChromaDB meeting_subtopicì— ì €ì¥                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. ë¦¬ë‹¤ì´ë ‰íŠ¸: /view/{meeting_id}                        â”‚
â”‚    - ì‚¬ìš©ìê°€ ëŒ€í™”ë¡/ìš”ì•½/íšŒì˜ë¡ í™•ì¸                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì´ ì†Œìš” ì‹œê°„**: ì•½ 60-90ì´ˆ (1ì‹œê°„ íšŒì˜ ê¸°ì¤€)

---

## 6.2 ì±—ë´‡ ì§ˆì˜ì‘ë‹µ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ì‚¬ìš©ì ì§ˆë¬¸ (viewer.html ì±—ë´‡ UI)                      â”‚
â”‚    "í”„ë¡œì íŠ¸ ì¼ì •ì€ ì–¸ì œê¹Œì§€ì•¼?"                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ POST /api/chat
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Flask (app.py:chat)                                  â”‚
â”‚    - ê¶Œí•œ ì²´í¬: can_access_meeting()                     â”‚
â”‚    - meeting_id ìˆìŒ â†’ í•´ë‹¹ ë…¸íŠ¸ë§Œ                       â”‚
â”‚    - meeting_id ì—†ìŒ â†’ accessible_meeting_ids ì¡°íšŒ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ query, meeting_id/accessible_ids
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ChatManager.process_query()                          â”‚
â”‚    â”œâ”€ search_documents()                                â”‚
â”‚    â”‚   â”œâ”€ VectorDB.search(db_type="chunks", k=3)        â”‚
â”‚    â”‚   â”‚   â””â”€ Self-Query Retriever                      â”‚
â”‚    â”‚   â”‚       - ìì—°ì–´ â†’ ë©”íƒ€ë°ì´í„° í•„í„°                 â”‚
â”‚    â”‚   â”‚       - ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰                         â”‚
â”‚    â”‚   â””â”€ VectorDB.search(db_type="subtopic", k=3)      â”‚
â”‚    â”‚                                                     â”‚
â”‚    â”œâ”€ format_context()                                  â”‚
â”‚    â”‚   â””â”€ 6ê°œ ë¬¸ì„œ â†’ ì»¨í…ìŠ¤íŠ¸ ë¬¸ìì—´ ìƒì„±                  â”‚
â”‚    â”‚                                                     â”‚
â”‚    â””â”€ generate_answer()                                 â”‚
â”‚        â””â”€ Gemini 2.5 Flash API í˜¸ì¶œ                     â”‚
â”‚            - ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ ë‹µë³€ë§Œ                         â”‚
â”‚            - ì‚¬ì „ ì§€ì‹ ì‚¬ìš© ê¸ˆì§€                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ answer + sources
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ì‚¬ìš©ìì—ê²Œ ì‘ë‹µ (JSON)                                 â”‚
â”‚    {                                                    â”‚
â”‚      "answer": "í”„ë¡œì íŠ¸ëŠ” 2ì›” 15ì¼ê¹Œì§€...",              â”‚
â”‚      "sources": [                                       â”‚
â”‚        {                                                â”‚
â”‚          "type": "chunk",                               â”‚
â”‚          "meeting_id": "...",                           â”‚
â”‚          "title": "í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„",                      â”‚
â”‚          "start_time": 120                              â”‚
â”‚        }                                                â”‚
â”‚      ]                                                  â”‚
â”‚    }                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì´ ì†Œìš” ì‹œê°„**: ì•½ 1.5-3ì´ˆ

---

## 6.3 ê³µìœ  ê¸°ëŠ¥ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Owner (user_id=1)ê°€ ë…¸íŠ¸ ê³µìœ  ë²„íŠ¼ í´ë¦­               â”‚
â”‚    - ì´ë©”ì¼ ì…ë ¥: "colleague@example.com"               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ POST /api/share/{meeting_id}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Flask (app.py:share_meeting_api)                     â”‚
â”‚    - ê¶Œí•œ ì²´í¬: ownerë§Œ ê³µìœ  ê°€ëŠ¥                         â”‚
â”‚    - user_manager.share_meeting() í˜¸ì¶œ                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. UserManager.share_meeting()                          â”‚
â”‚    - ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ì¡°íšŒ: user_id=2                      â”‚
â”‚    - INSERT INTO meeting_shares                         â”‚
â”‚      (meeting_id, owner_id=1, shared_with_id=2)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Colleague (user_id=2)ê°€ ë¡œê·¸ì¸                        â”‚
â”‚    - /shared_notes ì ‘ì†                                 â”‚
â”‚    - get_shared_meetings(user_id=2) í˜¸ì¶œ                â”‚
â”‚      â””â”€ SELECT FROM meeting_dialogues                   â”‚
â”‚          LEFT JOIN meeting_shares                       â”‚
â”‚          WHERE shared_with_id = 2                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. ê³µìœ ë°›ì€ ë…¸íŠ¸ ëª©ë¡ í‘œì‹œ                                 â”‚
â”‚    - ë…¸íŠ¸ í´ë¦­ â†’ /view/{meeting_id}                      â”‚
â”‚    - can_access_meeting(2, meeting_id) â†’ True           â”‚
â”‚    - ì •ìƒ ì¡°íšŒ ê°€ëŠ¥ âœ…                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# 7. í™˜ê²½ ì„¤ì •

## 7.1 í™˜ê²½ ë³€ìˆ˜ (.env)

```bash
# OpenAI API (Embeddings)
OPENAI_API_KEY=sk-proj-...

# Google Gemini API (STT, ìš”ì•½, íšŒì˜ë¡)
GOOGLE_API_KEY=AIza...

# Firebase Authentication
FIREBASE_API_KEY=AIza...
FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_STORAGE_BUCKET=your-project.appspot.com
FIREBASE_MESSAGING_SENDER_ID=123456789
FIREBASE_APP_ID=1:123456789:web:abcdef
FIREBASE_MEASUREMENT_ID=G-ABCDEF123

# Flask Session Secret (ëœë¤ ë¬¸ìì—´)
FLASK_SECRET_KEY=your-super-secret-key-here
```

**ë³´ì•ˆ ì£¼ì˜ì‚¬í•­**:
- `.env` íŒŒì¼ì€ `.gitignore`ì— ì¶”ê°€ í•„ìˆ˜
- API í‚¤ëŠ” ì ˆëŒ€ ì½”ë“œì— í•˜ë“œì½”ë”©í•˜ì§€ ë§ ê²ƒ
- í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…

---

## 7.2 Firebase ì„¤ì •

### í´ë¼ì´ì–¸íŠ¸ ì„¤ì • (login.html)

```javascript
const firebaseConfig = {
    apiKey: "{{ firebase_config.apiKey }}",
    authDomain: "{{ firebase_config.authDomain }}",
    projectId: "{{ firebase_config.projectId }}",
    storageBucket: "{{ firebase_config.storageBucket }}",
    messagingSenderId: "{{ firebase_config.messagingSenderId }}",
    appId: "{{ firebase_config.appId }}",
    measurementId: "{{ firebase_config.measurementId }}"
};
```

### ì„œë²„ ì„¤ì • (firebase_auth.py)

```python
cred = credentials.Certificate({
    "type": "service_account",
    "project_id": os.getenv("FIREBASE_PROJECT_ID"),
    ...
})
firebase_admin.initialize_app(cred)
```

---

## 7.3 ffmpeg ì„¤ì¹˜

**Windows**:
```bash
# Chocolatey
choco install ffmpeg

# ë˜ëŠ” ìˆ˜ë™ ë‹¤ìš´ë¡œë“œ
https://ffmpeg.org/download.html
```

**Linux (Ubuntu/Debian)**:
```bash
sudo apt-get update
sudo apt-get install ffmpeg
```

**macOS**:
```bash
brew install ffmpeg
```

**í™•ì¸**:
```bash
ffmpeg -version
```

---

# 8. ì˜ì¡´ì„±

## 8.1 í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬

### Flask ê´€ë ¨
```
Flask==3.1.2                 # ì›¹ í”„ë ˆì„ì›Œí¬
Jinja2==3.1.6                # í…œí”Œë¦¿ ì—”ì§„
Werkzeug==3.1.3              # WSGI ìœ í‹¸ë¦¬í‹°
itsdangerous==2.2.0          # ì„¸ì…˜ ì„œëª…
```

### AI/ML
```
google-genai==1.47.0         # Gemini API
openai==2.6.1                # OpenAI API (Embeddings)
langchain==0.3.27            # RAG í”„ë ˆì„ì›Œí¬
langchain-chroma==1.0.0      # ChromaDB í†µí•©
langchain-openai==1.0.1      # OpenAI í†µí•©
chromadb==1.3.0              # ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤
```

### ë°ì´í„° ì²˜ë¦¬
```
pandas==2.3.3                # ë°ì´í„° ë¶„ì„
numpy==2.3.4                 # ìˆ˜ì¹˜ ì—°ì‚°
```

### ì¸ì¦
```
firebase-admin (í¬í•¨)         # Firebase Admin SDK
google-auth==2.42.1          # Google ì¸ì¦
```

### ìœ í‹¸ë¦¬í‹°
```
python-dotenv==1.2.1         # .env íŒŒì¼ ë¡œë“œ
requests==2.32.5             # HTTP ìš”ì²­
```

---

## 8.2 ì „ì²´ ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv

# ê°€ìƒí™˜ê²½ í™œì„±í™”
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt
```

---

## 8.3 requirements.txt ì£¼ìš” ë‚´ìš©

```
Flask==3.1.2
chromadb==1.3.0
langchain==0.3.27
langchain-chroma==1.0.0
langchain-openai==1.0.1
google-genai==1.47.0
openai==2.6.1
python-dotenv==1.2.1
pandas==2.3.3
numpy==2.3.4
requests==2.32.5
google-auth==2.42.1
```

**ì´ ì˜ì¡´ì„± ìˆ˜**: 163ê°œ (ê°„ì ‘ ì˜ì¡´ì„± í¬í•¨)

---

# 9. ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

## 9.1 ì„œë²„ ìš”êµ¬ì‚¬í•­

**ìµœì†Œ ì‚¬ì–‘**:
- CPU: 2 cores
- RAM: 4GB
- ë””ìŠ¤í¬: 20GB (SSD ê¶Œì¥)
- OS: Windows 10+ / Linux (Ubuntu 20.04+) / macOS 11+

**ê¶Œì¥ ì‚¬ì–‘**:
- CPU: 4 cores
- RAM: 8GB
- ë””ìŠ¤í¬: 50GB SSD
- OS: Linux (Ubuntu 22.04)

---

## 9.2 ì†Œí”„íŠ¸ì›¨ì–´ ìš”êµ¬ì‚¬í•­

- **Python**: 3.10 ì´ìƒ
- **ffmpeg**: ìµœì‹  ë²„ì „
- **SQLite**: 3.x (Python ë‚´ì¥)
- **ì¸í„°ë„· ì—°ê²°**: API í˜¸ì¶œìš©

---

## 9.3 ë¸Œë¼ìš°ì € ì§€ì›

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

---

# 10. ì¶”ê°€ ì°¸ê³  ìë£Œ

## 10.1 ê´€ë ¨ ë¬¸ì„œ

- `next.md` - ì¸ìˆ˜ì¸ê³„ ë¬¸ì„œ (ìƒì„¸ ê¸°ëŠ¥ ì„¤ëª…)
- `FLOWCHART.md` - ì‹œìŠ¤í…œ í”Œë¡œìš°ì°¨íŠ¸
- `ui_format.md` - UI ë””ìì¸ ê°€ì´ë“œ
- `ë°œí‘œìë£Œ_ì°¸ê³ ë¬¸ì„œ.md` - ë°œí‘œ ìë£Œ

## 10.2 ë²„ê·¸ ìˆ˜ì • ì´ë ¥

- `ê³ ì•„ë°ì´í„°_ë²„ê·¸_ìˆ˜ì •_ì™„ë£Œ.md` - ì‚­ì œ ë¡œì§ ë²„ê·¸ ìˆ˜ì •
- `JSON_íŒŒì‹±_ì˜¤ë¥˜_í•´ê²°_ê°€ì´ë“œ.md` - Gemini JSON ì˜¤ë¥˜ ì²˜ë¦¬

## 10.3 ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸

- `cleanup_orphan_data.py` - ê³ ì•„ ë°ì´í„° ì •ë¦¬
- `migrate_db.py` - DB ë§ˆì´ê·¸ë ˆì´ì…˜
- `check_text_format.py` - ChromaDB í…ìŠ¤íŠ¸ í˜•ì‹ í™•ì¸

---

**ì‘ì„±ì**: Claude Code
**ë¬¸ì„œ ë²„ì „**: 1.0
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-01-07

---

## ë¶€ë¡: ì½”ë“œ ì»¨ë²¤ì…˜

### Python ìŠ¤íƒ€ì¼
- PEP 8 ì¤€ìˆ˜
- í•¨ìˆ˜ëª…: snake_case
- í´ë˜ìŠ¤ëª…: PascalCase
- ìƒìˆ˜: UPPER_CASE

### ì£¼ì„
```python
def function_name(param1: str, param2: int) -> dict:
    """
    í•¨ìˆ˜ ì„¤ëª… (í•œ ì¤„ ìš”ì•½)

    Args:
        param1: ë§¤ê°œë³€ìˆ˜ 1 ì„¤ëª…
        param2: ë§¤ê°œë³€ìˆ˜ 2 ì„¤ëª…

    Returns:
        ë°˜í™˜ê°’ ì„¤ëª…

    Raises:
        Exception: ì˜ˆì™¸ ì„¤ëª…
    """
```

### JavaScript ìŠ¤íƒ€ì¼
- ES6+ í‘œì¤€
- ë³€ìˆ˜ëª…: camelCase
- ìƒìˆ˜: UPPER_CASE
- async/await ì‚¬ìš© (Promiseë³´ë‹¤ ì„ í˜¸)

---

**ì´ ë¬¸ì„œë¡œ ì‹œìŠ¤í…œ ì „ì²´ êµ¬ì¡°ë¥¼ ì´í•´í•˜ê³  ìœ ì§€ë³´ìˆ˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**
